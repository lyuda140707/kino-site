<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ú—ñ–π –∫–∞–±—ñ–Ω–µ—Ç ‚Äî KinoSite</title>


<meta http-equiv="Content-Security-Policy"
      content="default-src * 'self' data: blob: https: http:;
               script-src 'self' 'unsafe-inline' 'unsafe-eval' https://telegram.org https://oauth.telegram.org https://cdn.jsdelivr.net;
               frame-src https://oauth.telegram.org https://kino-site.top;
               connect-src *;
               style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
               font-src https://fonts.gstatic.com;">

<link rel="stylesheet" href="style.css" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<style>
.pro-actions {
  display:flex;
  flex-direction:column;
  gap:8px;
  margin-top:12px;
}
.pro-actions .btn {
  background:transparent;
  border:1px solid rgba(0,255,255,0.3);
  color:#00fff2;
}
.pro-actions .btn:hover {
  background:rgba(0,255,255,0.1);
}

body {
  background: #0b0c10;
  color: #e6e6e6;
  font-family: "Poppins", sans-serif;
  margin: 0;
  padding: 0;
}

/* === –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä === */
.profile-wrap {
  max-width: 1000px;
  margin: 40px auto;
  padding: 0 16px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
  gap: 20px;
}

/* === –ö–∞—Ä—Ç–∫–∏ === */
.card {
  background: #111318;
  border: 1px solid rgba(0, 255, 255, 0.08);
  border-radius: 14px;
  box-shadow: 0 0 10px rgba(0, 255, 255, 0.05);
  padding: 18px 20px;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.card:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 16px rgba(0, 255, 255, 0.2);
}

h1 {
  grid-column: 1 / -1;
  text-align: center;
  color: #00fff2;
  font-weight: 600;
  font-size: 26px;
  margin-bottom: 4px;
}

h3 {
  color: #00fff2;
  margin-top: 0;
  font-size: 18px;
}

/* === –ö–Ω–æ–ø–∫–∏ === */
.btn {
  padding: 9px 12px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  font-weight: 600;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.btn-primary {
  background: linear-gradient(45deg, #00fff2, #4a00e0);
  color: #fff;
}
.btn-ghost {
  background: transparent;
  border: 1px solid rgba(0, 255, 255, 0.3);
  color: #00fff2;
}
.btn:hover {
  transform: scale(1.03);
  box-shadow: 0 0 10px rgba(0,255,255,0.25);
}

/* === –ü—Ä–æ—Ñ—ñ–ª—å === */
#user-card {
  text-align: center;
}
#user-card h3 {
  font-size: 20px;
}
#user-card .muted {
  color: #9aa0a6;
  font-size: 13px;
}
.profile-actions {
  margin-top: 10px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* === –ó–∞–∫–ª–∞–¥–∫–∏ === */
.bookmark-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 14px;
  margin-top: 10px;
}
.bookmark-card {
  background: #0d0f14;
  border: 1px solid rgba(0,255,255,0.15);
  border-radius: 10px;
  overflow: hidden;
  cursor: pointer;
  transition: 0.2s;
}
.bookmark-card:hover {
  transform: scale(1.05);
  box-shadow: 0 0 12px rgba(0,255,255,0.25);
}
.bookmark-card img {
  width: 100%;
  height: 190px;
  object-fit: cover;
}
.bookmark-card p {
  margin: 8px;
  text-align: center;
  font-size: 13.5px;
  color: #eaeaea;
}

/* === –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è === */
.message-item {
  background: #0e1015;
  border: 1px solid rgba(0,255,255,0.1);
  border-radius: 10px;
  padding: 10px 12px;
  margin-bottom: 8px;
}
/* –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è –±–µ–π–¥–∂–∞ */
#messages-card {
  position: relative;
}
.message-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.message-body {
  margin-top: 6px;
  color: #ddd;
  font-size: 14px;
}
.msg-delete {
  background: transparent;
  border: 1px solid rgba(255,77,77,0.4);
  color: #ff6b6b;
  border-radius: 6px;
  padding: 3px 8px;
  font-size: 12px;
  cursor: pointer;
}
.msg-delete:hover {
  background: rgba(255,77,77,0.15);
}

/* === –§—É—Ç–µ—Ä === */
footer {
  grid-column: 1 / -1;
  text-align: center;
  color: #888;
  margin: 28px 0;
  font-size: 14px;
}
/* === üÜï –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (–±–µ–π–¥–∂) === */
.new-badge {
  position: absolute;
  top: 6px;
  right: 12px;
  background: linear-gradient(45deg, #00fff2, #4a00e0);
  color: #fff;
  border-radius: 50%;
  width: 22px;
  height: 22px;
  font-size: 12px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 10px rgba(0,255,255,0.4);
  animation: pulseBadge 1.5s infinite;
}

@keyframes pulseBadge {
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.2); opacity: 0.7; }
  100% { transform: scale(1); opacity: 1; }
}
/* === üîî –ë–µ–π–¥–∂ –Ω–∞ –∫–Ω–æ–ø—Ü—ñ "–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è" === */
.msg-btn-badge {
  position: absolute;
  top: -6px;
  right: -6px;
  background: linear-gradient(45deg, #00fff2, #4a00e0);
  color: #fff;
  border-radius: 50%;
  width: 18px;
  height: 18px;
  font-size: 11px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 8px rgba(0,255,255,0.4);
  animation: pulseBadge 1.5s infinite;
}
/* === üí¨ –ú–û–î–ê–õ–ö–ê === */
.modal {
  display: none;
  position: fixed;
  z-index: 9999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  align-items: center;
  justify-content: center;
}
.modal-content {
  background: #111318;
  border: 1px solid rgba(0,255,255,0.2);
  border-radius: 14px;
  padding: 24px;
  max-width: 400px;
  color: #e6e6e6;
  text-align: center;
  box-shadow: 0 0 25px rgba(0,255,255,0.3);
  animation: fadeIn 0.3s ease;
}
.modal-actions {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 20px;
}
@keyframes fadeIn {
  from { transform: scale(0.9); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
.pro-actions #btn-paid-tg,
.pro-actions #btn-paid-web {
  display: none; /* –±–µ–∑ !important */
}
</style>
<meta name="referrer" content="no-referrer-when-downgrade">
</head>
<body>
<div id="header-placeholder"></div>
<script src="header.js"></script>

</script>


<main class="profile-wrap">
  <h1>–ú—ñ–π –∫–∞–±—ñ–Ω–µ—Ç</h1>

  <!-- üß© –ë–ª–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
  <div class="card" id="user-card" style="display:none;">
  <h3 id="hello-line">–í—ñ—Ç–∞—é!</h3>
  <p id="auth-type" class="muted"></p> <!-- üÜï –î–û–î–ê–ô –¶–ï -->
  <p class="muted">–°—Ç–∞—Ç—É—Å: <span id="pro-status">‚Äî</span></p>
  <button class="btn btn-ghost" id="logout-btn">–í–∏–π—Ç–∏</button>

  <!-- üîπ –î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
  <div class="profile-actions">
  <button id="messages" class="btn btn-ghost">üì© –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</button>
</div>
</div>
<!-- üß© –û–ø–ª–∞—Ç–∞ —Ç–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è -->
<div class="pro-actions" style="margin-top:14px;">
  <div id="pro-status-text" class="muted">–ü–µ—Ä–µ–≤—ñ—Ä—è—é —Å—Ç–∞—Ç—É—Å...</div>
  <button id="get-pro" class="btn btn-primary">üíé –û—Ç—Ä–∏–º–∞—Ç–∏ PRO</button>
  <!-- –ö–Ω–æ–ø–∫–∏ -->
  <button id="btn-paid-tg" class="btn btn-ghost" style="display:none;">
    ‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞) ‚Äî —á–µ—Ä–µ–∑ Telegram
  </button>
  <button id="btn-paid-web" class="btn btn-ghost" style="display:none;">
    ‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞) ‚Äî –±–µ–∑ Telegram
  </button>
</div>

<!-- ‚≠ê –ú–æ—ó –∑–∞–∫–ª–∞–¥–∫–∏ —É –∫–∞–±—ñ–Ω–µ—Ç—ñ -->
<div class="card" id="favorites-card">
  <div class="fav-head">
    <h3 style="margin:0;color:#00fff2;">‚≠ê –ú–æ—ó –∑–∞–∫–ª–∞–¥–∫–∏</h3>
    <button id="favClearBtn" class="fav-clear">üóë –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ</button>
  </div>
  <div id="favoritesList" class="bookmark-grid"></div>
</div>
<!-- üì© –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—ó -->
<div class="card" id="messages-card" style="display:none;">
  <h3 style="margin:0 0 10px;color:#00fff2;">üì© –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</h3>
  <div id="messagesList"></div>
</div>

  <!-- üì® –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è Email -->
  <div class="card" id="auth-card">
    <h3>–£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ Email</h3>
    <div style="display:flex;flex-direction:column;gap:8px;max-width:320px;">
      <input id="email-input" class="input" type="email" placeholder="email@example.com" />
      <button class="btn btn-primary" id="email-login-btn">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –≤—Ö–æ–¥—É</button>
    </div>
  </div>

  <!-- ü§ñ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è Telegram -->
  <div class="card" id="telegram-card">
    <h3>–£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram</h3>
    <p class="muted">
      –Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –Ω–∞—à Telegram-–±–æ—Ç, —Ü–µ–π —Å–ø–æ—Å—ñ–± –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î –≤–∞—à PRO-—Å—Ç–∞—Ç—É—Å.
    </p>
<!-- üîπ –ù–æ–≤–∞ –∫–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥—É —á–µ—Ä–µ–∑ Telegram -->
<button id="tg-login" class="btn btn-primary">–£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram</button>

<script>
  const BOT_ID = 8320301500;  // üîπ –∑–∞–º—ñ–Ω–∏ —Ü—ñ —Ü–∏—Ñ—Ä–∏ –Ω–∞ —Å–≤—ñ–π –±–æ—Ç ID (–¥–æ –¥–≤–æ–∫—Ä–∞–ø–∫–∏ –≤ —Ç–æ–∫–µ–Ω—ñ)
  const ORIGIN = "https://kino-site.top";
  const VERIFY_URL = "https://script.google.com/macros/s/AKfycbxkfUNvzZBuJEsb6nqBVs1oNrqmB5GwfcjXMq7jmgEWMvaMTTL4HJ90qE42Yqoiz6ea-g/exec";

  document.getElementById("tg-login").onclick = () => {
    const url = `https://oauth.telegram.org/auth?bot_id=${BOT_ID}&origin=${encodeURIComponent(ORIGIN)}&request_access=write`;
    window.location.href = url;
  };

  // üü¢ –∫–æ–ª–∏ Telegram –ø–æ–≤–µ—Ä—Ç–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—ñ—Å–ª—è –≤—Ö–æ–¥—É
  if (location.hash.startsWith("#tgAuthResult=")) {
    const dataStr = decodeURIComponent(location.hash.replace("#tgAuthResult=", ""));
    const payload = Object.fromEntries(new URLSearchParams(dataStr));

    fetch(VERIFY_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ tg_data: payload })
    })
    .then(r => r.json())
    .then(res => {
      if (res.ok) {
        localStorage.setItem("telegram_user", JSON.stringify(res.user));
        alert("‚úÖ –í—Ö—ñ–¥ —É—Å–ø—ñ—à–Ω–∏–π!");
        location.href = "/profile";
      } else {
        alert("‚ùå " + res.error);
      }
    })
    .catch(err => alert("‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞: " + err.message));
  }
</script>


<script>


  // === üü¢ –ê–≤—Ç–æ–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è Telegram —Å–µ—Å—ñ—ó ===
  window.addEventListener("DOMContentLoaded", () => {
    const saved = localStorage.getItem("telegram_user");
    if (!saved) return;

    try {
      const user = JSON.parse(saved);
      // —Ö–æ–≤–∞—î–º–æ –∫–∞—Ä—Ç–∫—É Telegram
      const tgCard = document.getElementById("telegram-card");
      if (tgCard) tgCard.style.display = "none";

      // –ø–æ–∫–∞–∑—É—î–º–æ –ø—Ä–æ—Ñ—ñ–ª—å–Ω—É –∫–∞—Ä—Ç–∫—É
      const userCard = document.getElementById("user-card");
      if (userCard) userCard.style.display = "block";

      // –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è
      document.getElementById("hello-line").innerText = `–í—ñ—Ç–∞—é, ${user.first_name || ""} ${user.last_name || ""}`.trim();
      document.getElementById("auth-type").innerText = "ü§ñ –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Telegram";

      // –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏
      if (typeof handleTelegramUser === "function") handleTelegramUser(user);
      if (typeof checkProStatus === "function") checkProStatus();
      if (typeof updateProUI === "function") updateProUI();
    } catch (e) {
      console.warn("–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ TG-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:", e);
    }
  });
</script>


  </div>
</main>

<footer style="text-align:center;color:#8a8f98;margin:32px 0">¬© 2025 KinoSite</footer>
<script>
// === ‚≠ê –ó–∞–∫–ª–∞–¥–∫–∏ –≤ –∫–∞–±—ñ–Ω–µ—Ç—ñ ===
function getLocalBookmarks() {
  try { return JSON.parse(localStorage.getItem("bookmarks") || "[]"); }
  catch { return []; }
}

function renderBookmarksInProfile() {
  const card = document.getElementById("favorites-card");
  const listEl = document.getElementById("favoritesList");
  if (!card || !listEl) return;

  const list = Array.isArray(getLocalBookmarks()) ? getLocalBookmarks() : [];
  listEl.innerHTML = "";

  if (!list.length) {
    listEl.innerHTML = "<p style='color:#9aa0a6;text-align:center;width:100%;margin:6px 0 2px;'>–ü–æ–∫–∏ —â–æ –ø–æ—Ä–æ–∂–Ω—å–æ üïØÔ∏è</p>";
  } else {
    list.forEach(item => {
      const id = item?.id ?? "";
      const title = item?.title || "–ë–µ–∑ –Ω–∞–∑–≤–∏";
      const poster = item?.poster || "https://via.placeholder.com/150x210?text=No+Image";
      // üëá –Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î–º–æ type, —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞
      const type = item?.type
        || (id ? "–§—ñ–ª—å–º" : "")                             // —è–∫—â–æ —î id ‚Äî –º–∞–π–∂–µ —Ç–æ—á–Ω–æ —Ñ—ñ–ª—å–º
        || (title?.toLowerCase().includes("–º—É–ª—å—Ç") ? "–ú—É–ª—å—Ç—Å–µ—Ä—ñ–∞–ª" : "–°–µ—Ä—ñ–∞–ª"); // —ñ–Ω–∞–∫—à–µ —Å–µ—Ä—ñ–∞–ª/–º—É–ª—å—Ç

      // –ö—É–¥–∏ –≤–µ—Å—Ç–∏ –ø–æ –∫–ª—ñ–∫—É
      let href = `film.html?id=${encodeURIComponent(id)}`;
      if (type === "–°–µ—Ä—ñ–∞–ª") href = `series.html?title=${encodeURIComponent(title)}`;
      if (type === "–ú—É–ª—å—Ç—Å–µ—Ä—ñ–∞–ª") href = `multseries.html?title=${encodeURIComponent(title)}`;

      const div = document.createElement("div");
      div.className = "bookmark-card";
      div.innerHTML = `
        <img src="${poster}" alt="${title}">
        <p>${title}</p>
      `;
      div.onclick = () => {
        // —è–∫—â–æ –≤–∏–ø–∞–¥–∫–æ–≤–æ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—ñ–¥–∫—Ä–∏–≤–∞—î –±–µ–∑ .html ‚Äî –¥–æ–¥–∞—î–º–æ —ó—ó
        if (!href.endsWith(".html") && !href.includes(".html?")) {
          if (href.includes("series")) href = "series.html" + href.split("series")[1];
          else if (href.includes("multseries")) href = "multseries.html" + href.split("multseries")[1];
          else if (href.includes("film")) href = "film.html" + href.split("film")[1];
        }
        window.location.href = href;
      };

      listEl.appendChild(div);
    });
  }

  card.style.display = "block";
}

document.getElementById("favClearBtn")?.addEventListener("click", () => {
  if (!confirm("–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –∑–∞–∫–ª–∞–¥–∫–∏?")) return;
  localStorage.removeItem("bookmarks");
  renderBookmarksInProfile();
});

window.addEventListener("DOMContentLoaded", renderBookmarksInProfile);
renderBookmarksInProfile();
</script>


<!-- ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabaseUrl = "https://zerlqvbmqszomlondlte.supabase.co";
  const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InplcmxxdmJtcXN6b21sb25kbHRlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzMzg3NzQsImV4cCI6MjA3MDkxNDc3NH0.8wUBYIeQRC6KVp6vdzv0oqofIf4PeZyzbV5GcD0vxTE";
  const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

  // ===== –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Email
  document.getElementById("email-login-btn").onclick = async () => {
    const email = document.getElementById("email-input").value.trim();
    if (!email) return alert("–í–≤–µ–¥—ñ—Ç—å email");
    const { error } = await supabase.auth.signInWithOtp({ email });
    alert(error ? "–ü–æ–º–∏–ª–∫–∞: " + error.message : "–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ—à—Ç—É, —â–æ–± —É–≤—ñ–π—Ç–∏!");
  };
  // ‚úÖ –ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤–µ—Ä–Ω—É–≤—Å—è –ø–æ –ª—ñ–Ω–∫—É –∑ –ø–æ—à—Ç–∏ ‚Äî –ø—ñ–¥—Ö–æ–ø–ª—é—î–º–æ —Å–µ—Å—ñ—é —ñ –ø–æ–∫–∞–∑—É—î–º–æ –∫–∞–±—ñ–Ω–µ—Ç
window.addEventListener("DOMContentLoaded", async () => {
  const { data, error } = await supabase.auth.getUser();
  const user = data?.user || null;

  if (user) {
    // –∑–±–µ—Ä–µ–∂–µ–º–æ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ª–æ–∫–∞–ª—å–Ω–æ
    localStorage.setItem("email_user", JSON.stringify({ id: user.id, email: user.email }));

    // –ø–æ–∫–∞–∑–∞—Ç–∏ –∫–∞–±—ñ–Ω–µ—Ç / —Å—Ö–æ–≤–∞—Ç–∏ —Ñ–æ—Ä–º–∏ –≤—Ö–æ–¥—É
    document.getElementById("auth-card").style.display = "none";
    document.getElementById("telegram-card").style.display = "none";
    document.getElementById("user-card").style.display = "block";
    document.getElementById("hello-line").innerText = `–í—ñ—Ç–∞—é, ${user.email}`;
    document.getElementById("auth-type").innerText = "üîë –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Email";

    // –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å PRO —Ç–∞ –∫–Ω–æ–ø–∫–∏, —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—ó –≤–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ
    if (typeof checkProStatus === "function") checkProStatus();
    if (typeof updateProUI === "function") updateProUI();
  }
});

// ‚úÖ –†–µ–∞–≥—É—î–º–æ –Ω–∞ –±—É–¥—å-—è–∫—É –∑–º—ñ–Ω—É —Å—Ç–∞–Ω—É (—â–æ–± –∫–∞–±—ñ–Ω–µ—Ç –∑‚Äô—è–≤–∏–≤—Å—è –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è e-mail)
supabase.auth.onAuthStateChange(async (event, session) => {
  if (session?.user) {
    localStorage.setItem("email_user", JSON.stringify({ id: session.user.id, email: session.user.email }));
    document.getElementById("auth-card").style.display = "none";
    document.getElementById("telegram-card").style.display = "none";
    document.getElementById("user-card").style.display = "block";
    document.getElementById("hello-line").innerText = `–í—ñ—Ç–∞—é, ${session.user.email}`;
    document.getElementById("auth-type").innerText = "üîë –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Email";
    if (typeof checkProStatus === "function") checkProStatus();
    if (typeof updateProUI === "function") updateProUI();
  }
});


  // ===== –í–∏—Ö—ñ–¥
  document.getElementById("logout-btn").onclick = async () => {
    try { await supabase.auth.signOut(); } catch(e) { console.warn(e); }
    localStorage.removeItem("telegram_user");
    localStorage.removeItem("email_user");
    localStorage.removeItem("pro_payment_started");
    location.reload();
  };


  // ===== –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –æ–±—Ä–æ–±–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  async function handleTelegramUser(user) {
  document.getElementById("auth-card").style.display = "none";
  document.getElementById("telegram-card").style.display = "none";
  document.getElementById("user-card").style.display = "block";

  document.getElementById("hello-line").innerText =
    `–í—ñ—Ç–∞—é, ${user.first_name || ""} ${user.last_name || ""}`.trim();
  // üÜï –ø–æ–∫–∞–∑—É—î–º–æ —Ç–∏–ø –≤—Ö–æ–¥—É ‚Äî Telegram
  const typeLine = document.getElementById("auth-type");
  if (typeLine) typeLine.innerText = "ü§ñ –í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Telegram";


    try {
      const res = await fetch(`${window.APPS_SCRIPT_URL}?user_id=${encodeURIComponent(user.id)}`);
      const json = await res.json();
      if (json.isPro) {
        // –Ø–∫—â–æ –¥–∞—Ç–∞ –≤–∂–µ —É —Ñ–æ—Ä–º–∞—Ç—ñ 30.11.2025 ‚Äî –Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ
        let d = json.expireDate;
        if (d && d.includes("-")) {
          d = d.split("T")[0].split("-").reverse().join(".");
        }
        document.getElementById("pro-status").innerHTML = `‚úÖ PRO –∞–∫—Ç–∏–≤–Ω–∏–π –¥–æ <b>${d || "–Ω–µ–≤—ñ–¥–æ–º–æ"}</b>`;
      } else {
        document.getElementById("pro-status").innerText = "‚ùå –ë–µ–∑ PRO";
      }
    } catch (err) {
      console.error(err);
      document.getElementById("pro-status").innerText = "‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ PRO";
    }
       await tryBindWebToTg(user);
       await checkProStatus();
      // ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
      loadMessagesForUser(user.id);
  }
function getWebId() {
  let webId = localStorage.getItem("web_id");
  if (!webId) {
    // üß© –°—Ç–≤–æ—Ä—é—î–º–æ –ø–æ—Å—Ç—ñ–π–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
    const base = btoa(navigator.userAgent + navigator.language + "kino-site");
    webId = "WEB-" + base.slice(0, 12);
    localStorage.setItem("web_id", webId);
  }
  return webId;
}
// üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É PRO
async function checkProStatus() {
  const tgUser = localStorage.getItem("telegram_user");
  const emailUser = localStorage.getItem("email_user");

  let idParam = "";
  let paramType = "";

  if (tgUser) {
    idParam = JSON.parse(tgUser).id;
    paramType = "user_id";
  } else if (emailUser) {
    idParam = getWebId();  // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ web_id
    paramType = "user_id"; // —à—É–∫–∞—î–º–æ —è–∫ –∑–≤–∏—á–∞–π–Ω–∏–π ID
  } else {
    idParam = getWebId();
    paramType = "web_id";
  }

  if (!idParam) {
    console.warn("‚ùå –ù–µ–º–∞—î ID –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ PRO");
    document.getElementById("pro-status-text").innerText = "üîí –ë–µ–∑ PRO";
    return;
  }

  const statusEl = document.getElementById("pro-status-text");
  statusEl.innerText = "‚è≥ –ü–µ—Ä–µ–≤—ñ—Ä—è—é —Å—Ç–∞—Ç—É—Å...";

  // üß† 1Ô∏è‚É£ –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–µ—à (6 –≥–æ–¥–∏–Ω)
  const cache = localStorage.getItem("pro_cache");
  if (cache) {
    try {
      const cached = JSON.parse(cache);
      if (cached.id === idParam && Date.now() - cached.time < 6 * 60 * 60 * 1000) {
        console.log("‚ö° –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –∫–µ—à–æ–≤–∞–Ω–∏–π PRO —Å—Ç–∞—Ç—É—Å");
        showProStatus(cached.data);
        return;
      }
    } catch (_) {}
  }

  // üåê 2Ô∏è‚É£ –Ø–∫—â–æ –∫–µ—à—É –Ω–µ–º–∞—î ‚Äî —Ä–æ–±–∏–º–æ —Ä–µ–∞–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç
  try {
    const url = `${window.APPS_SCRIPT_URL}?${paramType}=${encodeURIComponent(idParam)}`;
    const res = await fetch(url);
    const data = await res.json();

    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –∫–µ—à
    localStorage.setItem("pro_cache", JSON.stringify({
      id: idParam,
      data,
      time: Date.now()
    }));

    showProStatus(data);
  } catch (err) {
    console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ PRO:", err);
    statusEl.innerText = "‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏";
  }
}

// üß© –§—É–Ω–∫—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
function showProStatus(data) {
  const statusEl = document.getElementById("pro-status-text");
  const proLabel = document.getElementById("pro-status");

  if (data?.ok && data?.isPro) {
    const d = data?.expireDate || "–Ω–µ–≤—ñ–¥–æ–º–æ";
    statusEl.innerHTML = `üíé PRO –∞–∫—Ç–∏–≤–Ω–∏–π –¥–æ <b>${d}</b>`;
    if (proLabel) proLabel.innerHTML = `‚úÖ PRO –∞–∫—Ç–∏–≤–Ω–∏–π –¥–æ <b>${d}</b>`;
    localStorage.removeItem("pro_payment_started");
    localStorage.setItem("isPro", "true");
  } else {
    statusEl.innerText = "üîí –ë–µ–∑ PRO";
    if (proLabel) proLabel.innerText = "‚ùå –ë–µ–∑ PRO";
    localStorage.setItem("isPro", "false");
  }

  updateProUI();
}

async function tryBindWebToTg(tgUser) {
  if (!tgUser?.id) return;
  
  // –°–ø–æ—á–∞—Ç–∫—É –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ PRO —É–∂–µ –∞–∫—Ç–∏–≤–Ω–∏–π –¥–ª—è —Ü—å–æ–≥–æ Telegram ID
  try {
    const checkUrl = `${window.APPS_SCRIPT_URL}?user_id=${encodeURIComponent(tgUser.id)}`;
    const resCheck = await fetch(checkUrl);
    const jsonCheck = await resCheck.json();
    
    // –Ø–∫—â–æ PRO —É–∂–µ –∞–∫—Ç–∏–≤–Ω–∏–π ‚Äî –Ω—ñ—á–æ–≥–æ –Ω–µ –ø—Ä–∏–≤'—è–∑—É—î–º–æ, –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—É—î–º–æ
    if (jsonCheck?.ok && jsonCheck?.isPro) {
      console.log("üíé PRO —É–∂–µ –∞–∫—Ç–∏–≤–Ω–∏–π –¥–ª—è —Ü—å–æ–≥–æ Telegram –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:", tgUser.id);
      await checkProStatus();
      return;
    }
  } catch (err) {
    console.warn("–ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ TG PRO:", err);
  }

  // –Ø–∫—â–æ PRO —â–µ –Ω–µ–º–∞—î, –ø—Ä–æ–±—É—î–º–æ –∑–≤'—è–∑–∞—Ç–∏ WEB ‚Üí TG
  const webId = localStorage.getItem("web_id");
  if (!webId) return;

  try {
    const url = `${window.APPS_SCRIPT_URL}?action=bind_web_to_tg` +
      `&web_id=${encodeURIComponent(webId)}` +
      `&tg_id=${encodeURIComponent(tgUser.id)}` +
      `&tg_name=${encodeURIComponent(tgUser.username || "")}`;
    const res  = await fetch(url);
    const json = await res.json();
    console.log("üîó Bind WEB ‚Üí TG:", json);
  } catch (e) {
    console.warn("Bind failed:", e);
  }
}




  // ===== –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
  window.addEventListener("DOMContentLoaded", () => {
    const savedUser = localStorage.getItem("telegram_user");
    if (savedUser) {
      try {
        const user = JSON.parse(savedUser);
        console.log("üîÑ –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ localStorage:", user);
        document.getElementById("telegram-card").style.display = "none";
        handleTelegramUser(user);
      } catch (e) {
        console.warn("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:", e);
      }
    }
  });
// === üì© –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ ===
async function loadMessagesForUser(userId) {
  const box = document.getElementById("messagesList");
  if (!box) return;
  box.innerHTML = `<p class="muted">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>`;

  const { data, error } = await supabase
    .from("user_messages")
    .select("*")
    .eq("user_id", String(userId))
    .order("created_at", { ascending: false });

  if (error) {
    console.error(error);
    box.innerHTML = `<p class="muted">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</p>`;
    return;
  }

  if (!data?.length) {
    box.innerHTML = `<p class="muted">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å</p>`;
    return;
  }

  const lastCount = Number(localStorage.getItem("last_msg_count") || 0);
  localStorage.setItem("last_msg_count", data.length);

  const isNew = data.length > lastCount;
  const msgBtn = document.getElementById("messages");
const msgCard = document.getElementById("messages-card");

// üü¢ –Ø–∫—â–æ —î –Ω–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è ‚Äî –¥–æ–¥–∞—î–º–æ –±–µ–π–¥–∂
if (isNew && msgBtn) {
  msgBtn.style.position = "relative";
  const btnBadge = document.createElement("div");
  btnBadge.className = "msg-btn-badge";
  msgBtn.appendChild(btnBadge);
}

// üü£ –ü—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É ‚Äî –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ / –∑–∞–∫—Ä–∏–≤–∞—Ç–∏ –±–ª–æ–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
if (msgBtn && msgCard) {
  msgBtn.addEventListener("click", () => {
    const isVisible = msgCard.style.display === "block";
    msgCard.style.display = isVisible ? "none" : "block";

    // –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–∫—Ä–∏–≤ ‚Äî –ø—Ä–∏–±—Ä–∞—Ç–∏ –±–µ–π–¥–∂
    if (!isVisible) {
      const badge = msgBtn.querySelector(".msg-btn-badge");
      if (badge) badge.remove();
    }
  });
}



  box.innerHTML = "";
  data.forEach((m) => {
    const card = document.createElement("div");
    card.className = "message-item" + (isNew ? " new" : "");
    card.innerHTML = `
      <div class="message-header">
        <b>${m.title || "–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"}</b>
        <small style="color:#9aa0a6">${new Date(m.created_at).toLocaleString()}</small>
      </div>
      <div class="message-body">${m.body || ""}</div>
      ${m.from_name ? `<small style="color:#7bd9ff">‚Äî ${m.from_name}</small>` : ""}
      <button class="msg-delete">üóë –í–∏–¥–∞–ª–∏—Ç–∏</button>
    `;
    card.querySelector(".msg-delete").addEventListener("click", async () => {
      if (!confirm("–í–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è?")) return;
      await supabase.from("user_messages").delete().eq("id", m.id);
      card.remove();
    });
    box.appendChild(card);
  });
}
</script>
<script>
  // üîó –ù–æ–≤–∏–π Apps Script –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ PRO
  window.APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwUULSEmTKFORqOa3VwnQijTmNGw7Mt8bFd82G_HR7xwPSNlarMzE3Tmyrn1nju5WVPbA/exec";
</script>

<script src="auth.js"></script>
<script>
/* === üíé –ü–†–û-–æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Monobank / Telegram === */

// üîó –¢–≤–æ—ó URL-–∏
const BACKEND_URL = "https://script.google.com/macros/s/AKfycbxW2_rhnZ2Q8a7BQJJA89Ij_65tKSmf6gr8XmOIE9Au0i_BQVv_6PS0xx5sWgKYQ16J/exec";


// üÜî –û—Ç—Ä–∏–º–∞—Ç–∏ Telegram –∞–±–æ Web ID
function getTgId() {
  const u = localStorage.getItem("telegram_user");
  try { return u ? JSON.parse(u).id : null; } catch { return null; }
}

function updateProUI() {
  const btnTg = document.getElementById("btn-paid-tg");
  const btnWeb = document.getElementById("btn-paid-web");
  const getProBtn = document.getElementById("get-pro");
  const statusEl = document.getElementById("pro-status-text");

  // üîπ –•–æ–≤–∞—î–º–æ –≤—Å–µ —Å–ø–æ—á–∞—Ç–∫—É
  btnTg.style.display = "none";
  btnWeb.style.display = "none";
  if (getProBtn) getProBtn.style.display = "inline-block";

  // üîπ –Ø–∫—â–æ PRO —É–∂–µ –∞–∫—Ç–∏–≤–Ω–∏–π ‚Äî —Ö–æ–≤–∞—î–º–æ –∫–Ω–æ–ø–∫–∏ –æ–ø–ª–∞—Ç–∏
  if (statusEl.innerText.includes("üíé PRO –∞–∫—Ç–∏–≤–Ω–∏–π")) {
    getProBtn.style.display = "none";
    btnTg.style.display = "none";
    btnWeb.style.display = "none";
    return;
  }

  // üîπ –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ—á–∞–≤ –æ–ø–ª–∞—Ç—É
  if (localStorage.getItem("pro_payment_started") === "true") {
    const hasTg = !!localStorage.getItem("telegram_user");
    const hasEmail = !!localStorage.getItem("email_user");

    // –ø–æ–∫–∞–∑—É—î–º–æ —Ç—ñ–ª—å–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –∫–Ω–æ–ø–∫—É
    if (hasTg) {
      btnTg.style.display = "inline-block";
      btnWeb.style.display = "none";
    } else if (hasEmail) {
      btnWeb.style.display = "inline-block";
      btnTg.style.display = "none";
    } else {
      // —è–∫—â–æ –Ω–µ–≤—ñ–¥–æ–º–æ —Ö—Ç–æ ‚Äî –ø–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É –¥–ª—è –≥–æ—Å—Ç–µ–π (web)
      btnWeb.style.display = "inline-block";
    }

    // —Ö–æ–≤–∞—î–º–æ –∫–Ω–æ–ø–∫—É "–û—Ç—Ä–∏–º–∞—Ç–∏ PRO"
    getProBtn.style.display = "none";
  }
}





// üì§ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—É –ø—Ä–æ –æ–ø–ª–∞—Ç—É (—á–µ—Ä–µ–∑ Telegram)
async function notifyPaymentTG() {
  const tg_id = getTgId();
  if (!tg_id) return alert("–°–ø–æ—á–∞—Ç–∫—É –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—è —á–µ—Ä–µ–∑ Telegram!");
  try {
    const res = await fetch(BACKEND_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ user_id: tg_id, source: "site" })
    });
    if (!res.ok) throw new Error("notify-payment failed");
    alert("‚úÖ –ó–∞–ø–∏—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–¥–º—ñ–Ω—É. –ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è PRO –∞–∫—Ç–∏–≤—É—î—Ç—å—Å—è.");
  } catch (e) {
    console.error(e);
    alert("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç. –ù–∞–ø–∏—à—ñ—Ç—å –∞–¥–º—ñ–Ω—É.");
  }
}

// üì§ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—É (–¥–ª—è –≥–æ—Å—Ç–µ–π –±–µ–∑ Telegram)
async function notifyPaymentWEB() {
  const web_id = getWebId();
  try {
    const res = await fetch(BACKEND_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ web_id, source: "site" })
    });
    if (!res.ok) throw new Error("notify-payment failed");
    alert(
      "‚úÖ –ó–∞–ø–∏—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–¥–º—ñ–Ω—É.\n–ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è PRO –∞–∫—Ç–∏–≤—É—î—Ç—å—Å—è.\n–í–∞—à WEB-ID: " + web_id
    );
  } catch (e) {
    console.error(e);
    alert("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.");
  }
}


// üîÑ –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
window.addEventListener("DOMContentLoaded", () => {
  updateProUI();
  document.getElementById("btn-paid-tg").onclick  = notifyPaymentTG;
  document.getElementById("btn-paid-web").onclick = notifyPaymentWEB;
  checkProStatus();
  
});
</script>
<!-- === üí¨ –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –ü–†–û –û–ü–õ–ê–¢–£ === -->
<div id="proModal" class="modal">
  <div class="modal-content">
    <h3>üíé –û—Ç—Ä–∏–º–∞—Ç–∏ PRO –¥–æ—Å—Ç—É–ø</h3>
    <p>
     –ü—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏ —á–µ—Ä–µ–∑ Monobank –æ–±–æ–≤ º—è–∑–∫–æ–≤–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É 
     <b style="color:#ff4bf2; text-shadow:0 0 6px rgba(255,75,242,0.6);">
       ¬´–Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞)¬ª
     </b>, —â–æ–± –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–≤ –≤–∞—à PRO.
   </p>
    <div class="modal-actions">
      <button id="confirmPay" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ–ø–ª–∞—Ç–∏ üí≥</button>
      <button id="closeModal" class="btn btn-ghost">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>
  </div>
</div>

<script>
// === üí≥ –ú–æ–¥–∞–ª–∫–∞ + –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ Monobank ===
const modal = document.getElementById("proModal");
const btnGetPro = document.getElementById("get-pro");
const btnConfirmPay = document.getElementById("confirmPay");
const btnClose = document.getElementById("closeModal");

// 1Ô∏è‚É£ –ö–ª—ñ–∫ "–û—Ç—Ä–∏–º–∞—Ç–∏ PRO" ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é
btnGetPro.addEventListener("click", () => {
  const hasTg = !!localStorage.getItem("telegram_user");
  const hasEmail = !!localStorage.getItem("email_user");

  if (!hasTg && !hasEmail) {
    alert("‚ö†Ô∏è –°–ø–æ—á–∞—Ç–∫—É —É–≤—ñ–π–¥—ñ—Ç—å —á–µ—Ä–µ–∑ Telegram –∞–±–æ Email, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ PRO.");
    return;
  }

  // —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–≤—ñ–π—à–æ–≤ ‚Äî –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª–∫—É
  modal.style.display = "flex";
});

// 2Ô∏è‚É£ –°–∫–∞—Å—É–≤–∞—Ç–∏ ‚Äî –∑–∞–∫—Ä–∏—Ç–∏ –º–æ–¥–∞–ª–∫—É
btnClose.addEventListener("click", () => {
  modal.style.display = "none";
});

// 3Ô∏è‚É£ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è ‚Üí –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ Monobank —ñ –ø–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É "–Ø –æ–ø–ª–∞—Ç–∏–≤"
btnConfirmPay.addEventListener("click", () => {
  modal.style.display = "none";

  // üíæ –ó–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É—î–º–æ, —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ—á–∞–≤ –æ–ø–ª–∞—Ç—É
  localStorage.setItem("pro_payment_started", "true");

  // üí° –û–¥—Ä–∞–∑—É –æ–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —â–æ–± –ø–æ–∫–∞–∑–∞—Ç–∏ –∫–Ω–æ–ø–∫–∏ "–Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞)"
  updateProUI();

  // üîó –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ Monobank –±–∞–Ω–∫—É —É –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ
  const monoUrl = "https://send.monobank.ua/jar/8FbfB4fY6S";
  window.open(monoUrl, "_blank");

  alert("üí≥ –û–ø–ª–∞—Ç–∞ –≤—ñ–¥–∫—Ä–∏–ª–∞—Å—å —É –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ.\n–ü—ñ—Å–ª—è –ø–µ—Ä–µ–∫–∞–∑—É –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´–Ø –æ–ø–ª–∞—Ç–∏–≤(–ª–∞)¬ª!");
});


// –ó–∞–∫—Ä–∏—Ç—Ç—è –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –º–æ–¥–∞–ª–∫–æ—é
window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};
</script>

<div id="footer-placeholder"></div>
<script>
  fetch("footer.html")
    .then(res => res.text())
    .then(html => {
      document.getElementById("footer-placeholder").innerHTML = html;
      // –ø—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ —Ñ—É—Ç–µ—Ä –∑‚Äô—è–≤–∏–≤—Å—è —É DOM ‚Äî –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ –ª–æ–≥—ñ–∫—É
      const s = document.createElement("script");
      s.src = "footer.js";
      document.body.appendChild(s);
    });
</script>


</body>
</html>
