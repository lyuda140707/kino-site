<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ó–±—ñ—Ä–∫–∞ ‚Äî KinoSite</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<div id="header-placeholder"></div>
<script>
  fetch("header.html")
    .then(r => r.text())
    .then(t => document.getElementById("header-placeholder").innerHTML = t);
</script>

<main class="container">
  <h1 id="collectionTitle">üé¨ –ó–±—ñ—Ä–∫–∞</h1>
  <div id="filmsList" class="film-grid"></div>
</main>

<footer>¬© 2025 KinoSite</footer>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabaseUrl = "https://zerlqvbmqszomlondlte.supabase.co";
  const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InplcmxxdmJtcXN6b21sb25kbHRlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzMzg3NzQsImV4cCI6MjA3MDkxNDc3NH0.8wUBYIeQRC6KVp6vdzv0oqofIf4PeZyzbV5GcD0vxTE";
  const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);


  async function loadCollection() {
    const params = new URLSearchParams(window.location.search);
    const name = params.get("name");
    const title = document.getElementById("collectionTitle");
    const container = document.getElementById("filmsList");

    title.textContent = name;

    const { data, error } = await supabase
      .from("films_site")
      .select("*")
      .ilike("collection", `%${name}%`);

    if (error) {
      container.innerHTML = "<p style='color:white;'>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.</p>";
      return;
    }

    if (!data.length) {
      container.innerHTML = "<p style='color:white;'>–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î —Ñ—ñ–ª—å–º—ñ–≤ —É —Ü—ñ–π –∑–±—ñ—Ä—Ü—ñ.</p>";
      return;
    }

    container.innerHTML = "";
    data.forEach(film => {
      const card = document.createElement("div");
      card.className = "film";
      card.innerHTML = `
        <div class="poster">
          <img src="${film.poster}" alt="${film.title}">
          ${String(film.pro_access || '').toUpperCase() === 'PRO' ? '<span class="badge plus">PRO</span>' : ''}
        </div>
        <div class="title">${film.title}</div>
        <div class="meta">${film.genre} ‚Ä¢ ${film.year}</div>
      `;
      card.onclick = () => window.location.href = "film.html?id=" + film.id;
      container.appendChild(card);
    });
  }

  document.addEventListener("DOMContentLoaded", loadCollection);
</script>
<style>
/* –°—ñ—Ç–∫–∞ —Ñ—ñ–ª—å–º—ñ–≤ */
.film-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); /* ‚úÖ –º–µ–Ω—à—ñ –∫–∞—Ä—Ç–∫–∏ */
  gap: 18px;
  padding: 20px;
  justify-items: center;
}

/* –ö–∞—Ä—Ç–∫–∞ —Ñ—ñ–ª—å–º—É */
.film {
  background: #111;
  border-radius: 10px;
  overflow: hidden;
  cursor: pointer;
  border: 1px solid rgba(0,255,255,0.15);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  width: 160px; /* ‚úÖ –∑–º–µ–Ω—à–µ–Ω–Ω—è —à–∏—Ä–∏–Ω–∏ */
}

.film:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px rgba(0,255,255,0.25);
}

/* –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è */
.film .poster img {
  width: 100%;
  height: 220px; /* ‚úÖ –Ω–∏–∂—á–∞ –≤–∏—Å–æ—Ç–∞ –ø–æ—Å—Ç–µ—Ä–∞ */
  object-fit: cover;
  border-bottom: 1px solid rgba(0,255,255,0.1);
}

/* –ù–∞–∑–≤–∞ —Ñ—ñ–ª—å–º—É */
.film .title {
  color: #fff;
  font-size: 14px; /* ‚úÖ –º–µ–Ω—à–µ —à—Ä–∏—Ñ—Ç */
  font-weight: 600;
  text-align: center;
  margin: 8px 0 4px;
}

/* –ú–µ—Ç–∞–¥–∞–Ω—ñ (–∂–∞–Ω—Ä, —Ä—ñ–∫) */
.film .meta {
  color: #aaa;
  font-size: 12px;
  text-align: center;
  margin-bottom: 10px;
}

/* PRO-–±–µ–π–¥–∂ */
.badge.plus {
  position: absolute;
  top: 8px;
  left: 8px;
  background: linear-gradient(90deg, #ff00cc, #3333ff);
  padding: 2px 6px;
  font-size: 10px;
  border-radius: 6px;
  color: #fff;
}
</style>

</body>
</html>
